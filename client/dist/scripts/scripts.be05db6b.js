"use strict";angular.module("clientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","chartjs"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/stats/:shorty?",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("clientApp").controller("HeaderController",["$scope","$location",function(a,b){a.isActive=function(a){return b.path().startsWith("/stats")&&a.startsWith("/stats")?!0:a===b.path()}}]),angular.module("clientApp").controller("MainCtrl",["$scope","$http",function(a,b){a.host=location.host,a.longUrl="",a.custom="",a.btn="GO!",a.takeShort=function(){var c=b.post("/rest/go-shorty",{longUrl:a.longUrl,custom:a.custom});c.success(function(b){console.log("Inserted!"),a.rispostaJson=b,a.shortUrl="http://"+a.host+"/"+a.rispostaJson.shortUrl,a.err=""}),c.error(function(b){a.rispostaJson=b||"request failed",a.err=a.rispostaJson.err,a.shortUrl=""})}}]),angular.module("clientApp").controller("AboutCtrl",["$scope","$http","$routeParams",function(a,b,c){function d(a){u=[];var b=document.createElement("canvas");b.width="200",b.height="200",b.setAttribute("id","bStats");var c=document.getElementById("browser-chart-container");c.removeChild(c.firstChild),c.appendChild(b);var d=document.getElementById("browser-desc-container");g(d);for(var e in a){var f={value:a[e],color:j[e],highlight:"#FF5A5E",label:e};u.push(f);var h=document.createElement("span"),i=document.createTextNode(e);h.appendChild(i),h.setAttribute("class","label label-default"),h.setAttribute("style","padding: 5px; margin:2px; background-color:"+j[e]),d.appendChild(h)}l={segmentShowStroke:!0,segmentStrokeColor:"#f5f5f5",animateScale:!0},m=document.getElementById("bStats").getContext("2d"),n=new Chart(m).Pie(u,l)}function e(a){v=[];var b=document.createElement("canvas");b.width="200",b.height="200",b.setAttribute("id","cStats");var c=document.getElementById("country-chart-container");c.removeChild(c.firstChild),c.appendChild(b);var d=document.getElementById("country-desc-container");g(d);for(var e in a){var f="#"+Math.floor(16777215*Math.random()).toString(16);k.hasOwnProperty(e)&&(f=k[e]);var h={value:a[e],color:f,highlight:"#FF5A5E",label:e};v.push(h);var i=document.createElement("span"),j=document.createTextNode(e);i.appendChild(j),i.setAttribute("class","label"),i.setAttribute("style","padding: 5px; margin:2px; background-color:"+f),d.appendChild(i)}o={segmentShowStroke:!0,segmentStrokeColor:"#f5f5f5",animateScale:!0},p=document.getElementById("cStats").getContext("2d"),q=new Chart(p).Pie(v,o)}function f(a){w=[];var b=document.getElementById("date-chart-container"),c=document.createElement("canvas");c.width=parseFloat(window.getComputedStyle(b).width),c.height="300",c.setAttribute("id","dStats"),b.removeChild(b.firstChild),b.appendChild(c);var d=[],e=[];for(var f in a)d.push(f);d.sort();for(var g=0;g<d.length;g++)e.push(a[d[g]]);w={labels:d,datasets:[{label:"date dataset",fillColor:"#FDD835",highlightFill:"#FFC107",data:e}]},s=document.getElementById("dStats").getContext("2d"),t=new Chart(s).Bar(w,r)}function g(a){for(;a.firstChild;)a.removeChild(a.firstChild)}a.shortUrl="";var h=document.getElementById("pie-charts"),i=document.getElementById("bar-chart");a.getStats=function(){var c=a.shortUrl;c=c.replace("http://"+location.host,"");var g=b.get("/rest/stats/"+c);g.success(function(b){a.rispostaJson=b,0!==a.rispostaJson.numClicks?(h.style.display="block",i.style.display="block"):(h.style.display="none",i.style.display="none"),console.log("lets stats!"),d(b.browserStats),e(b.countryStats),f(b.dateStats),a.err=""}),g.error(function(b){a.rispostaJson=b||"request failed",a.err=a.rispostaJson.err,a.shortUrl="",h.style.display="none",i.style.display="none"})},c.shorty&&(a.shortUrl=c.shorty,a.getStats());var j={chrome:"#00796B",firefox:"#FDB45C",safari:"#00BCD4",explorer:"#01579B",opera:"#F7464A",other:"#607D8B"},k={IT:"#8BC34A",DE:"#37474F",US:"#B71C1C",JP:"#F44336",FR:"#3F51B5",GB:"#0D47A1",IN:"#FF9800",ES:"#FFEB3B",MX:"#4CAF50"};this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"];var l,m,n,o,p,q,r,s,t,u=[],v=[],w=[]}]),angular.module("clientApp").run(["$templateCache",function(a){a.put("views/about.html",'<div class="jumbotron"> <p style="font-weight: bold; color: #B71C1C; font-size: 27px">Statistics</p> <form role="form"> <div class="row marketing"> <div class="form-group"> <p> <input type="text" ng-model="shortUrl" placeholder="Insert shortURL to get statistics" class="form-control input-lg"> </p> <p> <a class="btn btn-lg btn-success" ng-click="getStats()">go <span class="glyphicon glyphicon-ok"></span> </a> </p> <p> <div ng-show="err" class="alert alert-danger">{{err}}</div> </p> </div> </div> </form> </div> <div class="well h2" ng-show="rispostaJson"> <p class="text-center" style="color:#37474F"> number of clicks: <b> {{rispostaJson.numClicks}}</b> </p> </div> <div class="well h2 container-fluid" ng-show="rispostaJson.longUrl"> <p class="text-center" style="color:#37474F; word-wrap: break-word"> long URL: <b> {{rispostaJson.longUrl}}</b> </p> </div> <div id="bar-chart" class="well" style="display:none"> <div class="container-fluid" style="padding:10px"> <p ng-show="rispostaJson.dateStats" class="text-center h3" style="color:#37474F"><b>Clicks per month</b></p> <div id="date-chart-container"> </div> </div> </div> <div id="pie-charts" class="well" style="display:none"> <div class="container-fluid" style="padding:10px"> <div class="row text-center"> <div class="col-md-4 col-md-offset-1" style="padding:10px"> <div ng-show="rispostaJson.browserStats" class="row text-center"> <p class="text-center h3" style="color:#37474F; padding-bottom:20px"><b>Browser chart</b></p> </div> <div class="row" id="browser-chart-container" style="width:auto"> </div> <div class="row" id="browser-desc-container" style="width:auto; padding-top:30px"> </div> </div> <div class="col-md-4 col-md-offset-2" style="padding:10px"> <div ng-show="rispostaJson.countryStats" class="row text-center"> <p class="text-center h3" style="color:#37474F; padding-bottom:20px"><b>Country chart</b></p> </div> <div class="row" id="country-chart-container" style="width:auto"> </div> <div class="row" id="country-desc-container" style="width:auto; padding-top:30px"> </div> </div> </div> </div></div>'),a.put("views/main.html",'<!--<div class="row marketing">\n  <h1>Welcome to Go-shorty!</h1>\n            <form>\n            <p class="lead">Insert long url:<input type="text" ng-model="longUrl"></p>\n            <p>Insert custom url:<input type="text" ng-model="custom"></p> \n            <input type="button" value="GO!" ng-click="takeShort()">\n            </form>\n            <div ng-show="rispostaJson"><p>short: {{rispostaJson}}</p></div>\n</div>\n--> <p align="center"><a href="#/"><img src="images/logo.0249c5d7.png" class="img-responsive"></a></p> <div class="jumbotron"> <form role="form"> <div class="row marketing"> <div class="form-group"> <p> <input type="text" ng-model="longUrl" placeholder="Insert a long URL" class="form-control input-lg"> </p> <p> <input type="text" ng-model="custom" placeholder="Add custom text" class="form-control input-lg"> </p> <p> <a class="btn btn-lg btn-success" ng-href="#/" ng-click="takeShort()">go <span class="glyphicon glyphicon-ok"></span> </a> </p> <p> <div ng-show="shortUrl" class="alert alert-success"> {{shortUrl}}<a ng-href="{{rispostaJson.stats}}"> <span class="glyphicon glyphicon-stats" style="float:right"></span></a> </div> </p> <p> <div ng-show="err" class="alert alert-danger">{{err}}</div> </p> </div> </div> </form> </div>')}]);